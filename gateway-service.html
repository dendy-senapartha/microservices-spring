<!DOCTYPE html>
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\asciidoc/gateway-service.adoc at 2019-06-27 -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Microservices &#x2013; </title>
	<link rel="stylesheet" href="./css/bulma.css">
    <style type="text/css" media="all">
      @import url("./css/style.css");
      @import url("./css/site.css");
    </style>
    <meta http-equiv="Content-Language" content="en" />
<link rel="icon" href="./images/mitrais-logo.png">
				<link rel="stylesheet" href="./libs/highlightjs/github.css">
				<link rel="stylesheet" href="./css/mitrais.css">
				<script src="./libs/highlightjs/highlight.pack.js"></script>
				<script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="composite">
  <!-- START BANNER -->
  <nav id="banner" class="navbar has-shadow is-spaced">
	  <div class="container">
	  	  <div class="navbar-brand">
		  	  <a class="navbar-item" href="https://mitrais.github.io/microservice" id="bannerLeft"><h1 class="title is-5">Microservices</h1>
</a>

			  <div class="navbar-burger burger" data-target="navbarMenu">
				<span></span>
				<span></span>
				<span></span>
			  </div>
		  </div>
		  <div class="navbar-menu" id="navbarMenu">
			  <div class="navbar-start is-hidden-desktop">
			  <div class="navbar-item">
       <p class="menu-label">Documentation</p>
    <ul class="menu-list">
<li>
<a href="index.html" title="Overview">Overview</a></li>
<li>
<a href="project-layout.html" title="Project Layout">Project Layout</a></li>
<li>
<a href="#" title="Non-Functional">Non-Functional</a>
      <ul class="menu-list">
<li>
<a href="configuration-service.html" title="Configuration Service">Configuration Service</a></li>
<li>
<a href="registry-service.html" title="Registry Service">Registry Service</a></li>
<li>
<a class="is-active" href="#">Gateway Service</a></li>
      </ul></li>
<li>
<a href="#" title="Functional">Functional</a>
      <ul class="menu-list">
<li>
<a href="product-service.html" title="Product Service">Product Service</a></li>
<li>
<a href="account-service.html" title="Account Service">Account Service</a></li>
      </ul></li>
<li>
<a href="./tests.html" title="Tests">Tests</a></li>
    </ul>
       <p class="menu-label">Info and reports</p>
    <ul class="menu-list">
<li>
<a href="./project-info.html" title="Info">Info</a></li>
<li>
<a href="./project-reports.html" title="Reports">Reports</a></li>
<li>
<a href="./apidocs/" title="JavaDocs">JavaDocs</a></li>
    </ul>
       <p class="menu-label">Github</p>
    <ul class="menu-list">
<li>
<a href="https://github.com/Mitrais/microservices" class="externalLink" title="SCM">SCM</a></li>
<li>
<a href="https://github.com/Mitrais/microservices/issues" class="externalLink" title="Issues">Issues</a></li>
    </ul>
       <p class="menu-label">Mitrais</p>
    <ul class="menu-list">
<li>
<a href="https://www.mitrais.com" class="externalLink" title="Website">Website</a></li>
<li>
<a href="https://github.com/Mitrais" class="externalLink" title="Github">Github</a></li>
    </ul>
       <p class="menu-label">Icons</p>
    <ul class="menu-list">
<li>
<a href="https://github.com/Mitrais/microservices" class="externalLink" title="Github"><img class="imageLink" src="github" alt=""/>Github</a></li>
    </ul>
       <p class="menu-label">Overview</p>
    <ul class="menu-list">
<li>
<a href="./overview.html" title="Overview">Overview</a></li>
    </ul>
			  </div>
			  </div>
			  <div class="navbar-end">
			  	  <div class="navbar-brand">
				  					  </div>
			  </div>
		  </div>
	  </div>
  </nav>
  <!-- END BANNER -->
  <div class="main container">
	<div class="columns">
		<div class="column is-3">
			<aside class="menu is-hidden-mobile">
       <p class="menu-label">Documentation</p>
    <ul class="menu-list">
<li>
<a href="index.html" title="Overview">Overview</a></li>
<li>
<a href="project-layout.html" title="Project Layout">Project Layout</a></li>
<li>
<a href="#" title="Non-Functional">Non-Functional</a>
      <ul class="menu-list">
<li>
<a href="configuration-service.html" title="Configuration Service">Configuration Service</a></li>
<li>
<a href="registry-service.html" title="Registry Service">Registry Service</a></li>
<li>
<a class="is-active" href="#">Gateway Service</a></li>
      </ul></li>
<li>
<a href="#" title="Functional">Functional</a>
      <ul class="menu-list">
<li>
<a href="product-service.html" title="Product Service">Product Service</a></li>
<li>
<a href="account-service.html" title="Account Service">Account Service</a></li>
      </ul></li>
<li>
<a href="./tests.html" title="Tests">Tests</a></li>
    </ul>
       <p class="menu-label">Info and reports</p>
    <ul class="menu-list">
<li>
<a href="./project-info.html" title="Info">Info</a></li>
<li>
<a href="./project-reports.html" title="Reports">Reports</a></li>
<li>
<a href="./apidocs/" title="JavaDocs">JavaDocs</a></li>
    </ul>
       <p class="menu-label">Github</p>
    <ul class="menu-list">
<li>
<a href="https://github.com/Mitrais/microservices" class="externalLink" title="SCM">SCM</a></li>
<li>
<a href="https://github.com/Mitrais/microservices/issues" class="externalLink" title="Issues">Issues</a></li>
    </ul>
       <p class="menu-label">Mitrais</p>
    <ul class="menu-list">
<li>
<a href="https://www.mitrais.com" class="externalLink" title="Website">Website</a></li>
<li>
<a href="https://github.com/Mitrais" class="externalLink" title="Github">Github</a></li>
    </ul>
       <p class="menu-label">Icons</p>
    <ul class="menu-list">
<li>
<a href="https://github.com/Mitrais/microservices" class="externalLink" title="Github"><img class="imageLink" src="github" alt=""/>Github</a></li>
    </ul>
       <p class="menu-label">Overview</p>
    <ul class="menu-list">
<li>
<a href="./overview.html" title="Overview">Overview</a></li>
    </ul>
			</aside>
		</div>
		<div class="column is-9">
			<nav class="breadcrumb" aria-label="breadcrumbs">
<ul>
<li>
<a href="#" aria-current="page">Registry Service</a>
</li>
</ul>
			</nav>
			<article class="content"><h1>Registry Service</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The main function of the service is to provides registration of running services and auto-discover
services needed by other services. Example, when Product Service and Order Service are starting up,
it will register them self to this service, when Order Service need to contact Product Service, the
Registry Service will provides the ip address or hostname of Product Service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://www.plantuml.com/plantuml/svg/NOyn2eKm40NxFSMIpYBW4Rp15os3XIIB1jJ8PXMy_JT41Mrd7WElYjApRFC4O1eQV1G-i2NUlQKE-uXyGJ0r1xTPUTarCp0_TiGl5H8vXOnVaGZ07KRbVBHX9rQeTLbe_LIVoSLL1ccPwzz1JbUqkFFH7m00" alt="Embedded" width="600"/>
</div>
</div>
<div class="paragraph">
<p>The service utilised <a href="https://cloud.spring.io/spring-cloud-netflix/1.4.x/multi/multi_spring-cloud-eureka-server.html">Spring Cloud Netflix Eureka Server</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The configuration for this service is provided by Configuration Service. It will load configuration
with the application name <code>registry</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/config/registry.yml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># EUREKA DISCOVERY
eureka:
  client:
    healthcheck:
      enabled: true
    registerWithEureka: false # no need to register
    fetchRegistry: false # no need to discover other services
    serviceUrl:
      defaultZone: http://localhost:9091/eureka
  instance:
    instanceId: ${spring.application.name}:${spring.application.instance_id:${random.value}}
    leaseRenewalIntervalInSeconds: 5   # DO NOT DO THIS IN PRODUCTION
# TOMCAT
server:
  port: 9091
# ACTUATOR ENDPOINTS
management:
  endpoints:
    web:
      exposure:
        include:
          - health
          - info
          - env</code></pre>
</div>
</div>
<div class="paragraph">
<p><br/></p>
</div>
<div class="paragraph">
<p>One thing to note here is that we need to tell the service to load configuration from Configuration Service
by providing bootstrap file.
<br/></p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/bootstrap.yml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  application:
    name: registry
  cloud:
    config:
      uri:
        - http://localhost:9090
      fail-fast: true
      retry:
        initialInterval: 5000
        maxInterval: 5000
        maxAttempts: 10</code></pre>
</div>
</div>
<div class="paragraph">
<p><br/></p>
</div>
<div class="paragraph">
<p>The service also uses <a href="https://github.com/spring-projects/spring-retry">Spring Retry</a> to make sure that
when the Configuration Service is not available yet, it will retry to load the configuration several
times based on the given configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing">Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To test the service, build and run the project as described in <a href="project-layout.html">Project Layout</a>
then open the browser and access the following url format <code>[hostname]:[port]/[service-name]/[profile]</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[hostname]</code> is the server name or ip address e.g. localhost, 127.0.0.1</p>
</li>
<li>
<p><code>[port]</code> is the server port e.g. 9091</p>
</li>
<li>
<p><code>[service-name]</code> is the <em>configuration name</em>.</p>
</li>
<li>
<p><code>[profile]</code> is the <em>profile name</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default the service will run using port number 9091. To access the Eureka dashboard go to the
following url <a href="http://localhost:9091/" class="bare">http://localhost:9091/</a>. All services registered on this Registry Services will be displayed.</p>
</div>
<div class="paragraph">
<p><br/>
<br/></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/eureka-dashboard.png" alt="Embedded" width="600"/>
</div>
</div>
</div>
</div></article>
		</div>
	</div>
  </div>
  <footer class="footer">
      <div class="container">
      <!-- FOOTER-->
		<div class="columns">
			<div class="column is-6">
	        	Copyright &#169;      2019 <a href="https://www.mitrais.com">Mitrais</a>.
All rights reserved.			</div>
			<div class="column is-6">
                <a href="https://maven.apache.org/"><img src="./images/maven-feather.png"/></a>
                <a href="https://bulma.io"><img src="./images/bulma-logo.png"/></a>
			</div>
		</div>
      </div>
   </footer>
   <script async type="text/javascript" src="./js/script.js"></script>
  </body>
</html>
